<?
class MY_Verifica_ip
{

    function ip_externo($ip = null)
    {
        if($ip == null)
        {
            $ip = $_SERVER['REMOTE_ADDR'];
        }

        $er='/^(192\.168\.(10)?[0-3]|172\.1[67]\.[0-9]{1,3}|10\.(3|100)\.[0-9]{1,3}|10\.[789]\.[0-3])\.[0-9]{1,3}$/';
        if (preg_match($er,$ip)){
            $origem='interno';
        } else {
            $origem='externo';
        }
        return $origem;
    }
}

/*  Ips internos:
    192.168.0.0
    192.168.3.255

    192.168.100.0
    192.168.103.255

    172.16.0.0
    172.16.255.255

    172.17.0.0
    172.17.255.255

    10.7.0.0
    10.7.3.255

    10.8.0.0
    10.8.3.255

    10.9.0.0
    10.9.3.255

    10.3.0.0
    10.3.255.255

    10.100.0.0
    10.100.255.255
    */


?>
